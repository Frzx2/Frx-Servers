<Server_Properties>:
    name: "server_properties"

    MDBoxLayout:
        orientation: "vertical"
        md_bg_color: 0.1, 0.1, 0.12, 1
        padding: dp(12)
        spacing: dp(12)

        # --- Header ---
        MDLabel:
            text: "Server Properties"
            halign: "center"
            font_style: "H5"
            theme_text_color: "Custom"
            text_color: 1, 1, 1, 1
            size_hint_y: None
            height: dp(56)

        ScrollView:
            MDGridLayout:
                id: props_grid
                cols: 2
                adaptive_height: True
                size_hint_y: None
                height: self.minimum_height
                spacing: dp(12)

                # =================== SWITCH PROPERTIES ===================

                # Allow Flight
                MDCard:
                    size_hint_y: None
                    height: dp(84)
                    radius: [12]
                    md_bg_color: 0.15, 0.15, 0.18, 1
                    padding: dp(12)

                    MDBoxLayout:
                        spacing: dp(12)

                        MDBoxLayout:
                            orientation: "vertical"
                            MDLabel:
                                text: "Allow Flight"
                                theme_text_color: "Custom"
                                text_color: 1, 1, 1, 1
                            MDLabel:
                                id: allow_flight_status
                                text: "Disabled"
                                font_style: "Caption"
                                theme_text_color: "Custom"
                                text_color: 0.7, 0.7, 0.7, 1

                        AnchorLayout:
                            size_hint_x: None
                            width: dp(80)
                            anchor_x: "center"
                            anchor_y: "center"

                            MDSwitch:
                                id: allow_flight
                                active: False
                                on_active:
                                    allow_flight_status.text = "Enabled" if self.active else "Disabled"
                                    root.mark_change()

                # Allow Nether
                MDCard:
                    size_hint_y: None
                    height: dp(84)
                    radius: [12]
                    md_bg_color: 0.15, 0.15, 0.18, 1
                    padding: dp(12)

                    MDBoxLayout:
                        spacing: dp(12)

                        MDBoxLayout:
                            orientation: "vertical"
                            MDLabel:
                                text: "Allow Nether"
                                theme_text_color: "Custom"
                                text_color: 1, 1, 1, 1
                            MDLabel:
                                id: allow_nether_status
                                text: "Disabled"
                                font_style: "Caption"
                                theme_text_color: "Custom"
                                text_color: 0.7, 0.7, 0.7, 1

                        AnchorLayout:
                            size_hint_x: None
                            width: dp(80)
                            anchor_x: "center"
                            anchor_y: "center"

                            MDSwitch:
                                id: allow_nether
                                active: False
                                on_active:
                                    allow_nether_status.text = "Enabled" if self.active else "Disabled"
                                    root.mark_change()

                # Enable Command Block
                MDCard:
                    size_hint_y: None
                    height: dp(84)
                    radius: [12]
                    md_bg_color: 0.15, 0.15, 0.18, 1
                    padding: dp(12)

                    MDBoxLayout:
                        spacing: dp(12)

                        MDBoxLayout:
                            orientation: "vertical"
                            MDLabel:
                                text: "Enable Command Block"
                                theme_text_color: "Custom"
                                text_color: 1, 1, 1, 1
                            MDLabel:
                                id: enable_command_block_status
                                text: "Disabled"
                                font_style: "Caption"
                                theme_text_color: "Custom"
                                text_color: 0.7, 0.7, 0.7, 1

                        AnchorLayout:
                            size_hint_x: None
                            width: dp(80)
                            anchor_x: "center"
                            anchor_y: "center"

                            MDSwitch:
                                id: enable_command_block
                                active: False
                                on_active:
                                    enable_command_block_status.text = "Enabled" if self.active else "Disabled"
                                    root.mark_change()

                # Enforce Whitelist
                MDCard:
                    size_hint_y: None
                    height: dp(84)
                    radius: [12]
                    md_bg_color: 0.15, 0.15, 0.18, 1
                    padding: dp(12)

                    MDBoxLayout:
                        spacing: dp(12)

                        MDBoxLayout:
                            orientation: "vertical"
                            MDLabel:
                                text: "Enforce Whitelist"
                                theme_text_color: "Custom"
                                text_color: 1, 1, 1, 1
                            MDLabel:
                                id: enforce_whitelist_status
                                text: "Disabled"
                                font_style: "Caption"
                                theme_text_color: "Custom"
                                text_color: 0.7, 0.7, 0.7, 1

                        AnchorLayout:
                            size_hint_x: None
                            width: dp(80)
                            anchor_x: "center"
                            anchor_y: "center"

                            MDSwitch:
                                id: enforce_whitelist
                                active: False
                                on_active:
                                    enforce_whitelist_status.text = "Enabled" if self.active else "Disabled"
                                    root.mark_change()

                # Force Gamemode
                MDCard:
                    size_hint_y: None
                    height: dp(84)
                    radius: [12]
                    md_bg_color: 0.15, 0.15, 0.18, 1
                    padding: dp(12)

                    MDBoxLayout:
                        spacing: dp(12)

                        MDBoxLayout:
                            orientation: "vertical"
                            MDLabel:
                                text: "Force Gamemode"
                                theme_text_color: "Custom"
                                text_color: 1, 1, 1, 1
                            MDLabel:
                                id: force_gamemode_status
                                text: "Disabled"
                                font_style: "Caption"
                                theme_text_color: "Custom"
                                text_color: 0.7, 0.7, 0.7, 1

                        AnchorLayout:
                            size_hint_x: None
                            width: dp(80)
                            anchor_x: "center"
                            anchor_y: "center"

                            MDSwitch:
                                id: force_gamemode
                                active: False
                                on_active:
                                    force_gamemode_status.text = "Enabled" if self.active else "Disabled"
                                    root.mark_change()

                # Generate Structures
                MDCard:
                    size_hint_y: None
                    height: dp(84)
                    radius: [12]
                    md_bg_color: 0.15, 0.15, 0.18, 1
                    padding: dp(12)

                    MDBoxLayout:
                        spacing: dp(12)

                        MDBoxLayout:
                            orientation: "vertical"
                            MDLabel:
                                text: "Generate Structures"
                                theme_text_color: "Custom"
                                text_color: 1, 1, 1, 1
                            MDLabel:
                                id: generate_structures_status
                                text: "Disabled"
                                font_style: "Caption"
                                theme_text_color: "Custom"
                                text_color: 0.7, 0.7, 0.7, 1

                        AnchorLayout:
                            size_hint_x: None
                            width: dp(80)
                            anchor_x: "center"
                            anchor_y: "center"

                            MDSwitch:
                                id: generate_structures
                                active: False
                                on_active:
                                    generate_structures_status.text = "Enabled" if self.active else "Disabled"
                                    root.mark_change()

                # Hardcore
                MDCard:
                    size_hint_y: None
                    height: dp(84)
                    radius: [12]
                    md_bg_color: 0.15, 0.15, 0.18, 1
                    padding: dp(12)

                    MDBoxLayout:
                        spacing: dp(12)

                        MDBoxLayout:
                            orientation: "vertical"
                            MDLabel:
                                text: "Hardcore"
                                theme_text_color: "Custom"
                                text_color: 1, 1, 1, 1
                            MDLabel:
                                id: hardcore_status
                                text: "Disabled"
                                font_style: "Caption"
                                theme_text_color: "Custom"
                                text_color: 0.7, 0.7, 0.7, 1

                        AnchorLayout:
                            size_hint_x: None
                            width: dp(80)
                            anchor_x: "center"
                            anchor_y: "center"

                            MDSwitch:
                                id: hardcore
                                active: False
                                on_active:
                                    hardcore_status.text = "Enabled" if self.active else "Disabled"
                                    root.mark_change()

                # Hide Online Players
                MDCard:
                    size_hint_y: None
                    height: dp(84)
                    radius: [12]
                    md_bg_color: 0.15, 0.15, 0.18, 1
                    padding: dp(12)

                    MDBoxLayout:
                        spacing: dp(12)

                        MDBoxLayout:
                            orientation: "vertical"
                            MDLabel:
                                text: "Hide Online Players"
                                theme_text_color: "Custom"
                                text_color: 1, 1, 1, 1
                            MDLabel:
                                id: hide_online_players_status
                                text: "Disabled"
                                font_style: "Caption"
                                theme_text_color: "Custom"
                                text_color: 0.7, 0.7, 0.7, 1

                        AnchorLayout:
                            size_hint_x: None
                            width: dp(80)
                            anchor_x: "center"
                            anchor_y: "center"

                            MDSwitch:
                                id: hide_online_players
                                active: False
                                on_active:
                                    hide_online_players_status.text = "Enabled" if self.active else "Disabled"
                                    root.mark_change()

                # Online Mode
                MDCard:
                    size_hint_y: None
                    height: dp(84)
                    radius: [12]
                    md_bg_color: 0.15, 0.15, 0.18, 1
                    padding: dp(12)

                    MDBoxLayout:
                        spacing: dp(12)

                        MDBoxLayout:
                            orientation: "vertical"
                            MDLabel:
                                text: "Online Mode"
                                theme_text_color: "Custom"
                                text_color: 1, 1, 1, 1
                            MDLabel:
                                id: online_mode_status
                                text: "Disabled"
                                font_style: "Caption"
                                theme_text_color: "Custom"
                                text_color: 0.7, 0.7, 0.7, 1

                        AnchorLayout:
                            size_hint_x: None
                            width: dp(80)
                            anchor_x: "center"
                            anchor_y: "center"

                            MDSwitch:
                                id: online_mode
                                active: False
                                on_active:
                                    online_mode_status.text = "Enabled" if self.active else "Disabled"
                                    root.mark_change()

                # PvP
                MDCard:
                    size_hint_y: None
                    height: dp(84)
                    radius: [12]
                    md_bg_color: 0.15, 0.15, 0.18, 1
                    padding: dp(12)

                    MDBoxLayout:
                        spacing: dp(12)

                        MDBoxLayout:
                            orientation: "vertical"
                            MDLabel:
                                text: "PvP"
                                theme_text_color: "Custom"
                                text_color: 1, 1, 1, 1
                            MDLabel:
                                id: pvp_status
                                text: "Disabled"
                                font_style: "Caption"
                                theme_text_color: "Custom"
                                text_color: 0.7, 0.7, 0.7, 1

                        AnchorLayout:
                            size_hint_x: None
                            width: dp(80)
                            anchor_x: "center"
                            anchor_y: "center"

                            MDSwitch:
                                id: pvp
                                active: False
                                on_active:
                                    pvp_status.text = "Enabled" if self.active else "Disabled"
                                    root.mark_change()

                # Spawn Monsters
                MDCard:
                    size_hint_y: None
                    height: dp(84)
                    radius: [12]
                    md_bg_color: 0.15, 0.15, 0.18, 1
                    padding: dp(12)

                    MDBoxLayout:
                        spacing: dp(12)

                        MDBoxLayout:
                            orientation: "vertical"
                            MDLabel:
                                text: "Spawn Monsters"
                                theme_text_color: "Custom"
                                text_color: 1, 1, 1, 1
                            MDLabel:
                                id: spawn_monsters_status
                                text: "Disabled"
                                font_style: "Caption"
                                theme_text_color: "Custom"
                                text_color: 0.7, 0.7, 0.7, 1

                        AnchorLayout:
                            size_hint_x: None
                            width: dp(80)
                            anchor_x: "center"
                            anchor_y: "center"

                            MDSwitch:
                                id: spawn_monsters
                                active: False
                                on_active:
                                    spawn_monsters_status.text = "Enabled" if self.active else "Disabled"
                                    root.mark_change()

                # White List
                MDCard:
                    size_hint_y: None
                    height: dp(84)
                    radius: [12]
                    md_bg_color: 0.15, 0.15, 0.18, 1
                    padding: dp(12)

                    MDBoxLayout:
                        spacing: dp(12)

                        MDBoxLayout:
                            orientation: "vertical"
                            MDLabel:
                                text: "White List"
                                theme_text_color: "Custom"
                                text_color: 1, 1, 1, 1
                            MDLabel:
                                id: white_list_status
                                text: "Disabled"
                                font_style: "Caption"
                                theme_text_color: "Custom"
                                text_color: 0.7, 0.7, 0.7, 1

                        AnchorLayout:
                            size_hint_x: None
                            width: dp(80)
                            anchor_x: "center"
                            anchor_y: "center"

                            MDSwitch:
                                id: white_list
                                active: False
                                on_active:
                                    white_list_status.text = "Enabled" if self.active else "Disabled"
                                    root.mark_change()

                # =================== DROPDOWNS ===================
                # Difficulty
                MDCard:
                    size_hint_y: None
                    height: dp(84)
                    radius: [12]
                    md_bg_color: 0.15, 0.15, 0.18, 1
                    padding: dp(12)

                    MDBoxLayout:
                        spacing: dp(12)

                        MDLabel:
                            text: "Difficulty"
                            theme_text_color: "Custom"
                            text_color: 1, 1, 1, 1

                        MDDropDownItem:
                            id: difficulty
                            text: "easy"
                            size_hint_x: None
                            width: dp(160)
                            on_release: root.open_difficulty_menu(self)

                # Gamemode
                MDCard:
                    size_hint_y: None
                    height: dp(84)
                    radius: [12]
                    md_bg_color: 0.15, 0.15, 0.18, 1
                    padding: dp(12)

                    MDBoxLayout:
                        spacing: dp(12)

                        MDLabel:
                            text: "Gamemode"
                            theme_text_color: "Custom"
                            text_color: 1, 1, 1, 1

                        MDDropDownItem:
                            id: gamemode
                            text: "survival"
                            size_hint_x: None
                            width: dp(160)
                            on_release: root.open_gamemode_menu(self)

                # =================== NUMERIC FIELDS ===================
                # Max Players
                MDCard:
                    size_hint_y: None
                    height: dp(84)
                    radius: [12]
                    md_bg_color: 0.15, 0.15, 0.18, 1
                    padding: dp(12)
                    elevation: 6

                    MDBoxLayout:
                        orientation: "horizontal"
                        spacing: dp(12)
                        padding: dp(8)

                        MDLabel:
                            text: "Max Players"
                            theme_text_color: "Custom"
                            text_color: 1, 1, 1, 1
                            halign: "left"
                            valign: "center"

                        MDTextField:
                            id: max_players
                            text: "16"
                            size_hint_x: None
                            width: dp(100)
                            mode: "rectangle"
                            input_filter: "int"
                            halign: "center"
                            on_text: root.mark_change()

                # Max Tick Time
                MDCard:
                    size_hint_y: None
                    height: dp(84)
                    radius: [12]
                    md_bg_color: 0.15, 0.15, 0.18, 1
                    padding: dp(12)

                    MDBoxLayout:
                        spacing: dp(12)

                        MDLabel:
                            text: "Max Tick Time"
                            theme_text_color: "Custom"
                            text_color: 1, 1, 1, 1

                        MDTextField:
                            id: max_tick_time
                            text: "60000"
                            size_hint_x: None
                            width: dp(120)
                            mode: "rectangle"
                            input_filter: "int"
                            halign: "center"
                            on_text: root.mark_change()

                # Max World Size
                MDCard:
                    size_hint_y: None
                    height: dp(84)
                    radius: [12]
                    md_bg_color: 0.15, 0.15, 0.18, 1
                    padding: dp(12)

                    MDBoxLayout:
                        spacing: dp(12)

                        MDLabel:
                            text: "Max World Size"
                            theme_text_color: "Custom"
                            text_color: 1, 1, 1, 1

                        MDTextField:
                            id: max_world_size
                            text: "29999984"
                            size_hint_x: None
                            width: dp(140)
                            mode: "rectangle"
                            input_filter: "int"
                            halign: "center"
                            on_text: root.mark_change()

                # Pause When Empty Seconds
                MDCard:
                    size_hint_y: None
                    height: dp(84)
                    radius: [12]
                    md_bg_color: 0.15, 0.15, 0.18, 1
                    padding: dp(12)

                    MDBoxLayout:
                        spacing: dp(12)

                        MDLabel:
                            text: "Pause When Empty (sec)"
                            theme_text_color: "Custom"
                            text_color: 1, 1, 1, 1

                        MDTextField:
                            id: pause_when_empty
                            text: "60"
                            size_hint_x: None
                            width: dp(100)
                            mode: "rectangle"
                            input_filter: "int"
                            halign: "center"
                            on_text: root.mark_change()

                # Player Idle Timeout
                MDCard:
                    size_hint_y: None
                    height: dp(84)
                    radius: [12]
                    md_bg_color: 0.15, 0.15, 0.18, 1
                    padding: dp(12)

                    MDBoxLayout:
                        spacing: dp(12)

                        MDLabel:
                            text: "Player Idle Timeout"
                            theme_text_color: "Custom"
                            text_color: 1, 1, 1, 1

                        MDTextField:
                            id: player_idle_timeout
                            text: "0"
                            size_hint_x: None
                            width: dp(100)
                            mode: "rectangle"
                            input_filter: "int"
                            halign: "center"
                            on_text: root.mark_change()

                # Spawn Protection
                MDCard:
                    size_hint_y: None
                    height: dp(84)
                    radius: [12]
                    md_bg_color: 0.15, 0.15, 0.18, 1
                    padding: dp(12)

                    MDBoxLayout:
                        spacing: dp(12)

                        MDLabel:
                            text: "Spawn Protection"
                            theme_text_color: "Custom"
                            text_color: 1, 1, 1, 1

                        MDTextField:
                            id: spawn_protection
                            text: "16"
                            size_hint_x: None
                            width: dp(100)
                            mode: "rectangle"
                            input_filter: "int"
                            halign: "center"
                            on_text: root.mark_change()

        # --- Bottom Navigation ---
        MDCard:
            id: bottom_menu_card
            orientation: "horizontal"
            size_hint_y: None
            height: "60dp"
            padding: "10dp"
            spacing: "20dp"
            md_bg_color: 0.12, 0.12, 0.15, 1
            radius: [20, 20, 0, 0]
            elevation: 6

            MDLabel:
                id: tab_status
                text: "Server Status"
                halign: "center"
                font_style: "Button"
                theme_text_color: "Custom"
                text_color: 1, 1, 1, 1
                on_touch_down: if self.collide_point(*args[1].pos): root.set_screen("status")

            MDLabel:
                id: tab_players
                text: "Players"
                halign: "center"
                font_style: "Button"
                theme_text_color: "Custom"
                text_color: 1, 1, 1, 1
                on_touch_down: if self.collide_point(*args[1].pos): root.set_screen("players")

            MDLabel:
                id: tab_console
                text: "Console"
                halign: "center"
                font_style: "Button"
                theme_text_color: "Custom"
                text_color: 1, 1, 1, 1
                on_touch_down: if self.collide_point(*args[1].pos): root.set_screen("console")

            MDLabel:
                id: tab_logs
                text: "Logs"
                halign: "center"
                font_style: "Button"
                theme_text_color: "Custom"
                text_color: 1, 1, 1, 1
                on_touch_down: if self.collide_point(*args[1].pos): root.set_screen("server_file")

            MDLabel:
                id: tab_props
                text: "Properties"
                halign: "center"
                font_style: "Button"
                theme_text_color: "Custom"
                text_color: 1, 1, 1, 1
                on_touch_down: if self.collide_point(*args[1].pos): root.set_screen("server_properties")

            MDLabel:
                id: tab_home
                text: "Home"
                halign: "center"
                font_style: "Button"
                theme_text_color: "Custom"
                text_color: 1, 1, 1, 1
                on_touch_down: if self.collide_point(*args[1].pos): root.set_screen("homescreen")
